// external script
var move = import user_script/move
var weapon = import user_script/weapon

// initialize
move.set_harvest_pick(false)

// 変数
var boss_count = 0
var wand_motion_count = 0
var wand_using = 0

var bardiche_using = 0

// todo: 武器swap は氷デバフの考慮できていないので事故る状態
func attack()
  ?foe = bearer
    state1()
  :?foe = elementalist
    state2()
  :?foe = perfected
    state3()
  :
    move.walk()

// 第一形態
func state1()
  ?(time%300 = 0 | wand_using = 1) & wand_motion_count < 40
    loadout 0
    wand_using = 1
    wand_motion_count++
  :
    wand_using = 0
    wand_motion_count = 0
    // chill debuff を考慮に入れる必要がある
    ?time%20 = 0
      ?bardiche_using = 2
        loadout 3
        bardiche_using = 3
      :
        loadout 2
        bardiche_using = 2

// 第二形態
func state2()
  ?(time%300 = 0 | wand_using = 1) & wand_motion_count < 40
    loadout 0
    wand_using = 1
    wand_motion_count++
  :
    wand_using = 0
    wand_motion_count = 0
    // chill debuff を考慮に入れる必要がある
    ?time%20 = 0
      ?bardiche_using = 2
        loadout 3
        bardiche_using = 3
      :
        loadout 2
        bardiche_using = 2

// 第三形態
func state3()
  ?(time%85 = 0 | wand_using = 1) & wand_motion_count < 16
    loadout 8
    wand_using = 1
    wand_motion_count++
  :
    wand_using = 0
    wand_motion_count = 0
    ?time%20 = 0
      ?bardiche_using = 2
        loadout 3
        bardiche_using = 3
      :
        loadout 2
        bardiche_using = 2

/** ロッキー **/
?loc = rocky_plateau
  ?foe.distance >= 40
    move.walk()
  :
    attack()
  ?hp <= 10
      activate potion